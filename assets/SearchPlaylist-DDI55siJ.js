import{r as l,d as _,w as b,a as N,I,g as v,i as c,j as S,k as F,l as a,v as d,q as w,m as k,u as q,F as H,t as $,y as A,C as j,A as D,n as M,J as U,x as g,H as W}from"./index-yT-nRwf0.js";import{u as z,L as J,a as G}from"./LoadingEffect-C_Egt85T.js";import{P as K}from"./vuejs-paginate-next.es-MiVyFMoV.js";import{H as O,F as Q}from"./FooterView-CTXdy-ba.js";const X={class:"wrapper"},Y={class:"container"},Z={class:"d-flex justify-content-between align-items-center flex-sm-row flex-column"},ee={class:"fs-lg-2 fs-3 my-lg-8 my-sm-6 my-4"},ae={class:"text-warning"},te={class:"row row-cols-lg-6 row-cols-md-3 row-cols-2 gy-4"},se=["src","alt"],oe={class:"card-body"},le={class:"fs-lg-6 fs-7 mb-2"},ne={class:"fs-7"},re='<i class="bi bi-caret-left-fill"></i>',ie='<i class="bi bi-caret-right-fill"></i>',pe={__name:"SearchPlaylist",setup(ce){const x=z(),{getConfigAuthToken:P}=x,y=l({}),n=l({isLoading:!1,fullPage:!0,bgColor:"rgba(0,0,0,0.9)"}),C=_(()=>({active:n.value.isLoading,fullPage:n.value.fullPage,...n.value.bgColor&&{backgroundColor:n.value.bgColor}})),L=()=>{n.value.isLoading=!0},V=()=>{n.value.isLoading=!1},m=l({playlists:{data:[]}}),r=D(),R=W(),h=l(0),i=l(Number(r.query.page)||1),p=l(18),T=_(()=>Math.ceil(h.value/p.value)),B=s=>{i.value=s,R.push({query:{...r.query,page:s}}),M(()=>{const e=document.activeElement;e&&e.tagName==="A"&&e.blur()})};b(i,()=>{f(o.value),E()}),b(()=>r.query.page,s=>{i.value=Number(s)||1});const E=()=>{window.scrollTo({top:0,behavior:"smooth"})},o=l(""),f=s=>{L();const e=(i.value-1)*p.value,u=p.value;G.get(`https://api.kkbox.com/v1.1/search?q=${s}&territory=TW&type=artist,track,album,playlist&limit=${u}&offset=${e} `,y.value).then(t=>{m.value.playlists.data=t.data.playlists.data,h.value=t.data.playlists.summary.total,V()})};return N(async()=>{y.value=await P(),r.query.q&&(o.value=r.query.q,f(o.value))}),I(s=>{s.query.q&&(o.value=s.query.q,f(o.value))}),(s,e)=>{const u=U("RouterLink");return g(),v("div",X,[c(J,S(F(C.value)),null,16),c(O),a("main",null,[a("section",null,[a("div",Y,[a("div",Z,[a("h2",ee,[a("strong",ae,d(o.value),1),e[1]||(e[1]=w(" 歌單搜尋結果 "))]),c(u,{class:"btn-more-content mb-4 mb-sm-0",to:{name:"search",query:{q:q(r).query.q}}},{default:k(()=>[w(" 回到 "+d(o.value)+" 搜尋頁 ",1),e[2]||(e[2]=a("i",{class:"bi bi-arrow-left-circle"},null,-1))]),_:1},8,["to"])]),a("div",te,[(g(!0),v(H,null,$(m.value.playlists.data,t=>(g(),v("div",{class:"col",key:t.id},[c(u,{class:"card h-100",to:{name:"playlist",params:{playlistId:t.id}}},{default:k(()=>[a("img",{src:t.images[0].url,alt:t.title,class:"rounded-4"},null,8,se),a("div",oe,[a("h3",le,d(t.title),1),a("h4",ne,d(t.owner.name),1)])]),_:2},1032,["to"])]))),128))]),m.value.playlists.data.length!==0?(g(),A(q(K),{key:0,"page-count":T.value,"page-range":3,"margin-pages":2,"click-handler":B,"prev-text":re,"next-text":ie,"container-class":"pagination",class:"py-lg-8 py-6 overflow-x-auto",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value=t)},null,8,["page-count","modelValue"])):j("",!0)])])]),c(Q)])}}};export{pe as default};
