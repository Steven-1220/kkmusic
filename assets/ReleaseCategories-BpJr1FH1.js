import{r,d as $,s as F,f as N,w as V,a as z,g as t,i as g,j as H,k as W,l as e,v as o,F as k,t as x,u as j,A as q,x as l,z as G,B as J,H as K,n as O}from"./index-uAn1OuIp.js";import{u as Q,L as U,a as C}from"./LoadingEffect-CtI6JVtD.js";import{u as X}from"./musicPlayer-DaexMZiW.js";import{H as Y,F as Z}from"./FooterView-BdGcuZQ6.js";import{P as ee}from"./PlayAlbum-D5bsB9J0.js";const se={class:"wrapper"},ae={class:"new-release-categories py-lg-13 py-9"},te={class:"container"},oe={class:"fs-lg-2 fs-3 text-center"},le={class:"row px-3 px-sm-0"},ie={class:"list-unstyled d-flex gap-md-2 gap-1 flex-no-wrap overflow-x-auto mb-lg-4 mb-3 py-lg-5 py-3"},ne=["onClick"],re={class:"row"},ce={key:0,class:"col"},ue={class:"list-group list-group-flush mt-6"},de={class:"fw-bolder text-warning fs-5 fs-md-4"},me={class:"release-albums-info w-100 d-flex align-items-center ms-lg-5 ms-3"},ge=["src","alt"],fe={class:"ms-lg-4 ms-2"},pe={class:"single-name fs-6 fs-md-5 mb-1"},_e={class:"singer-name fs-7 fs-md-6 mb-2"},ve={class:"fs-7 fs-md-6 text-gray-300"},be={class:"d-flex ms-auto"},he=["onClick"],ye={key:1,class:"col"},we={class:"fs-4 fs-md-2 fs-lg-1 mt-9 mt-lg-12"},Re={__name:"ReleaseCategories",setup(ke){const M=Q(),{getConfigAuthToken:A}=M,f=r({}),i=r({isLoading:!1,fullPage:!0,bgColor:""}),P=$(()=>({active:i.value.isLoading,fullPage:i.value.fullPage,...i.value.bgColor&&{backgroundColor:i.value.bgColor}})),L=()=>{i.value.isLoading=!0},R=()=>{i.value.isLoading=!1},c=q(),T=K(),v=r([]),S=()=>{C.get("https://api.kkbox.com/v1.1/new-release-categories?territory=TW",f.value).then(a=>{v.value=a.data.data})},b=X(),{musicAlbumData:d,isMusicAlbumPlaying:p}=F(b),{resetMusicAlbumData:B}=b,m=r(null),I=a=>{d.value.id!==a&&(p.value&&m.value.closeMusicAlbumModal(),d.value.id=a,d.value.autoplay=!0,p.value=!0,O(()=>{setTimeout(()=>{m.value.showMusicAlbumModal()},300)}))},D=()=>{B()},E=()=>{p.value&&m.value.closeMusicAlbumModal()};N(()=>{E()});const h=r(""),_=a=>{h.value=a,T.push({name:"releaseCategories",params:{categoriesId:a}})},n=r({categoryId:"",categoryTitle:"",albums:[]}),y=a=>{L(),C.get(`https://api.kkbox.com/v1.1/new-release-categories/${a}?territory=TW`,f.value).then(u=>{n.value.categoryTitle=u.data.title,n.value.albums=u.data.albums.data,R()})};return V(()=>c.params.categoriesId,()=>{_(c.params.categoriesId),y(c.params.categoriesId)}),z(async()=>{f.value=await A(),S(),_(c.params.categoriesId),y(c.params.categoriesId)}),(a,u)=>(l(),t("div",se,[g(U,H(W(P.value)),null,16),g(Y),e("main",null,[e("section",ae,[e("div",te,[e("h2",oe," 新發行"+o(n.value.categoryTitle)+"歌曲 ",1),e("div",le,[e("ul",ie,[(l(!0),t(k,null,x(v.value,s=>(l(),t("li",{key:s.id},[e("a",{href:"#",class:G(["btn border btn-custom-info text-nowrap",{active:h.value===s.id}]),onClick:J(w=>_(s.id),["prevent"])},o(s.title),11,ne)]))),128))])]),e("div",re,[n.value.albums.length!==0?(l(),t("div",ce,[e("ul",ue,[(l(!0),t(k,null,x(n.value.albums,(s,w)=>(l(),t("li",{class:"list-group-item d-flex align-items-center release-album-item",key:s.id},[e("h4",de,o(w+1),1),e("div",me,[e("img",{src:s.images[0].url,alt:s.name},null,8,ge),e("div",fe,[e("h5",pe,o(s.name),1),e("h6",_e,o(s.artist.name),1),e("span",ve,o(s.release_date),1)])]),e("div",be,[e("button",{type:"button",class:"btn btn-custom-play",onClick:xe=>I(s.id)},u[0]||(u[0]=[e("i",{class:"bi bi-play-fill"},null,-1)]),8,he)])]))),128))])])):(l(),t("div",ye,[e("h2",we," 😓 抱歉，目前沒有新發行"+o(n.value.categoryTitle)+"相關歌曲 ",1)]))])]),g(ee,{ref_key:"musicAlbumModalRef",ref:m,"music-album-data":j(d),onEmitCloseMusicAlbumModal:D},null,8,["music-album-data"])])]),g(Z)]))}};export{Re as default};
